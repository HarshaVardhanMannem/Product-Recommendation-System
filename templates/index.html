<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Product Recommendation Assistant</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css')}}"/>
    
    <!-- Meta tags for SEO -->
    <meta name="description" content="AI-powered product recommendation chatbot for e-commerce">
    <meta name="keywords" content="AI, chatbot, product recommendation, e-commerce">
    <meta name="author" content="Harsha Vardhan">
</head>
	
	
<body>
    <div class="container-fluid h-100">
        <div class="row justify-content-center h-100">		
            <div class="col-lg-10 col-xl-8 chat">
                <div class="card">
                    <!-- Enhanced Header -->
                    <div class="card-header msg_head">
                        <div class="d-flex bd-highlight align-items-center">
                            <div class="img_cont">
                                <img src="https://static.vecteezy.com/system/resources/previews/016/017/018/non_2x/ecommerce-icon-free-png.png" 
                                     class="rounded-circle user_img" 
                                     alt="AI Assistant Avatar">
                                <span class="online_icon"></span>
                            </div>
                            <div class="user_info flex-grow-1">
                                <span><i class="fas fa-robot me-2"></i>AI Product Assistant</span>
                                <p><i class="fas fa-circle text-success me-1" style="font-size: 0.5rem;"></i>Online â€¢ Ready to help with product recommendations</p>
                            </div>
                            <div class="header-actions">
                                <button class="btn btn-sm btn-outline-light me-2" id="clearChat" title="Clear Chat">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-light" id="settingsBtn" title="Settings">
                                    <i class="fas fa-cog"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Message Area -->
                    <div id="messageFormeight" class="card-body msg_card_body">
                        <!-- Welcome Message -->
                        <div class="d-flex justify-content-start mb-4">
                            <div class="img_cont_msg">
                                <img src="https://static.vecteezy.com/system/resources/previews/016/017/018/non_2x/ecommerce-icon-free-png.png" 
                                     class="rounded-circle user_img_msg" alt="AI Assistant">
                            </div>
                            <div class="msg_cotainer">
                                <div class="welcome-message">
                                    <h6><i class="fas fa-sparkles me-2"></i>Welcome to AI Product Assistant!</h6>
                                    <p class="mb-2">I'm here to help you find the perfect products. You can ask me about:</p>
                                    <ul class="list-unstyled mb-0">
                                        <li><i class="fas fa-mobile-alt me-2 text-primary"></i>Smartphones and electronics</li>
                                        <li><i class="fas fa-laptop me-2 text-info"></i>Laptops and computers</li>
                                        <li><i class="fas fa-headphones me-2 text-warning"></i>Audio devices and accessories</li>
                                        <li><i class="fas fa-home me-2 text-success"></i>Home and lifestyle products</li>
                                    </ul>
                                    <small class="text-muted">Try asking: "What are the best smartphones under $500?" or "Compare gaming laptops"</small>
                                </div>
                                <span class="msg_time">Just now</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Enhanced Input Area -->
                    <div class="card-footer">
                        <form id="messageArea" class="input-group">
                            <input type="text" 
                                   id="text" 
                                   name="msg" 
                                   placeholder="Ask about products, compare features, or get recommendations..." 
                                   autocomplete="off" 
                                   class="form-control type_msg" 
                                   required
                                   maxlength="500"/>
                            <button type="submit" id="send" class="send_btn" title="Send Message">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </form>
                        
                        <!-- Quick Action Buttons -->
                        <div class="quick-actions mt-3">
                            <small class="text-muted me-3">Quick actions:</small>
                            <button class="btn btn-sm btn-outline-light me-2 quick-btn" data-query="Best smartphones under $500">
                                <i class="fas fa-mobile-alt me-1"></i>Smartphones
                            </button>
                            <button class="btn btn-sm btn-outline-light me-2 quick-btn" data-query="Top rated laptops for students">
                                <i class="fas fa-laptop me-1"></i>Laptops
                            </button>
                            <button class="btn btn-sm btn-outline-light me-2 quick-btn" data-query="Best wireless headphones">
                                <i class="fas fa-headphones me-1"></i>Audio
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
		
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    
    <script>
        $(document).ready(function() {
            // Auto-scroll to bottom
            function scrollToBottom() {
                const messageBody = document.getElementById('messageFormeight');
                messageBody.scrollTop = messageBody.scrollHeight;
            }
            
            // Format time
            function getCurrentTime() {
                const date = new Date();
                const hour = date.getHours().toString().padStart(2, '0');
                const minute = date.getMinutes().toString().padStart(2, '0');
                return hour + ":" + minute;
            }
            
            // Show typing indicator
            function showTypingIndicator() {
                const typingHtml = `
                    <div class="d-flex justify-content-start mb-4 typing-message">
                        <div class="img_cont_msg">
                            <img src="https://static.vecteezy.com/system/resources/previews/016/017/018/non_2x/ecommerce-icon-free-png.png" 
                                 class="rounded-circle user_img_msg" alt="AI Assistant">
                        </div>
                        <div class="typing-indicator">
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                        </div>
                    </div>
                `;
                $("#messageFormeight").append(typingHtml);
                scrollToBottom();
            }
            
            // Hide typing indicator
            function hideTypingIndicator() {
                $(".typing-message").remove();
            }
            
            // Send message function
            function sendMessage(message) {
                const currentTime = getCurrentTime();
                
                // Add user message
                const userHtml = `
                    <div class="d-flex justify-content-end mb-4">
                        <div class="msg_cotainer_send">
                            ${message}
                            <span class="msg_time_send">${currentTime}</span>
                        </div>
                        <div class="img_cont_msg">
                            <img src="https://i.ibb.co/d5b84Xw/Untitled-design.png" 
                                 class="rounded-circle user_img_msg" alt="User">
                        </div>
                    </div>
                `;
                
                $("#messageFormeight").append(userHtml);
                $("#text").val("");
                scrollToBottom();
                
                // Show typing indicator
                showTypingIndicator();
                
                // Send AJAX request
                $.ajax({
                    data: { msg: message },
                    type: "POST",
                    url: "/get",
                    timeout: 30000 // 30 second timeout
                }).done(function(data) {
                    hideTypingIndicator();
                    
                    // Add bot response
                    const botHtml = `
                        <div class="d-flex justify-content-start mb-4">
                            <div class="img_cont_msg">
                                <img src="https://static.vecteezy.com/system/resources/previews/016/017/018/non_2x/ecommerce-icon-free-png.png" 
                                     class="rounded-circle user_img_msg" alt="AI Assistant">
                            </div>
                            <div class="msg_cotainer">
                                ${data}
                                <span class="msg_time">${getCurrentTime()}</span>
                            </div>
                        </div>
                    `;
                    $("#messageFormeight").append($.parseHTML(botHtml));
                    scrollToBottom();
                }).fail(function(xhr, status, error) {
                    hideTypingIndicator();
                    
                    // Show error message
                    const errorHtml = `
                        <div class="d-flex justify-content-start mb-4">
                            <div class="img_cont_msg">
                                <img src="https://static.vecteezy.com/system/resources/previews/016/017/018/non_2x/ecommerce-icon-free-png.png" 
                                     class="rounded-circle user_img_msg" alt="AI Assistant">
                            </div>
                            <div class="msg_cotainer">
                                <i class="fas fa-exclamation-triangle me-2"></i>
                                Sorry, I'm having trouble connecting right now. Please try again in a moment.
                                <span class="msg_time">${getCurrentTime()}</span>
                            </div>
                        </div>
                    `;
                    $("#messageFormeight").append(errorHtml);
                    scrollToBottom();
                });
            }
            
            // Form submission
            $("#messageArea").on("submit", function(event) {
                event.preventDefault();
                const message = $("#text").val().trim();
                
                if (message) {
                    sendMessage(message);
                }
            });
            
            // Quick action buttons
            $(".quick-btn").on("click", function() {
                const query = $(this).data("query");
                $("#text").val(query);
                sendMessage(query);
            });
            
            // Clear chat functionality
            $("#clearChat").on("click", function() {
                if (confirm("Are you sure you want to clear the chat history?")) {
                    $("#messageFormeight").html(`
                        <div class="d-flex justify-content-start mb-4">
                            <div class="img_cont_msg">
                                <img src="https://static.vecteezy.com/system/resources/previews/016/017/018/non_2x/ecommerce-icon-free-png.png" 
                                     class="rounded-circle user_img_msg" alt="AI Assistant">
                            </div>
                            <div class="msg_cotainer">
                                <div class="welcome-message">
                                    <h6><i class="fas fa-sparkles me-2"></i>Welcome to AI Product Assistant!</h6>
                                    <p class="mb-2">I'm here to help you find the perfect products. You can ask me about:</p>
                                    <ul class="list-unstyled mb-0">
                                        <li><i class="fas fa-mobile-alt me-2 text-primary"></i>Smartphones and electronics</li>
                                        <li><i class="fas fa-laptop me-2 text-info"></i>Laptops and computers</li>
                                        <li><i class="fas fa-headphones me-2 text-warning"></i>Audio devices and accessories</li>
                                        <li><i class="fas fa-home me-2 text-success"></i>Home and lifestyle products</li>
                                    </ul>
                                    <small class="text-muted">Try asking: "What are the best smartphones under $500?" or "Compare gaming laptops"</small>
                                </div>
                                <span class="msg_time">Just now</span>
                            </div>
                        </div>
                    `);
                }
            });
            
            // Settings button (placeholder)
            $("#settingsBtn").on("click", function() {
                alert("Settings panel coming soon! ðŸš€");
            });
            
            // Auto-focus on input
            $("#text").focus();
            
            // Enter key handling
            $("#text").on("keypress", function(e) {
                if (e.which === 13 && !e.shiftKey) {
                    e.preventDefault();
                    $("#messageArea").submit();
                }
            });
            
            // Character counter
            $("#text").on("input", function() {
                const maxLength = 500;
                const currentLength = $(this).val().length;
                const remaining = maxLength - currentLength;
                
                // You can add a character counter display here if needed
                if (remaining < 50) {
                    $(this).addClass("text-warning");
                } else {
                    $(this).removeClass("text-warning");
                }
            });
        });
    </script>
        
    </body>
</html>